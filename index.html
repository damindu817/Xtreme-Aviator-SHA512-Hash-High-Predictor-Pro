<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>XTREME AVIATOR SHA512 HASH HIGH PREDICTOR PRO</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #3a86ff;
      --primary-dark: #2667cc;
      --secondary: #8338ec;
      --danger: #ff006e;
      --success: #06d6a0;
      --warning: #ffbe0b;
      --dark-1: #0a0e17;
      --dark-2: #121827;
      --dark-3: #1e2538;
      --light-1: #f8f9fa;
      --light-2: #e9ecef;
      --accent: #3a86ff;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--dark-1), var(--dark-2));
      color: var(--light-1);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      touch-action: manipulation;
    }
    
    .main-container {
      width: 100%;
      max-width: 800px;
      background: var(--dark-2);
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .header {
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      padding: 20px;
      text-align: center;
      position: relative;
    }
    
    .header h1 {
      font-weight: 600;
      font-size: 1.8rem;
      margin-bottom: 5px;
    }
    
    .header p {
      opacity: 0.9;
      font-size: 0.9rem;
    }
    
    .datetime {
      display: flex;
      justify-content: space-between;
      background: rgba(0, 0, 0, 0.2);
      padding: 10px 20px;
      font-size: 0.9rem;
    }
    
    .content {
      padding: 25px;
    }
    
    .input-group {
      margin-bottom: 20px;
      position: relative;
    }
    
    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      font-size: 0.9rem;
      color: var(--light-2);
    }
    
    #hashInput {
      width: 100%;
      padding: 14px 16px;
      background: var(--dark-3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: var(--light-1);
      font-size: 1rem;
      transition: all 0.3s ease;
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
    
    #hashInput:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(58, 134, 255, 0.2);
    }
    
    .input-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 10px;
    }
    
    .clear-btn {
      background: rgba(255, 0, 110, 0.2);
      color: var(--danger);
      border: none;
      border-radius: 8px;
      padding: 10px 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .clear-btn:hover {
      background: rgba(255, 0, 110, 0.3);
    }
    
    .odd-buttons {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 12px;
      margin: 25px 0;
    }
    
    .odd-btn {
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--dark-3);
      color: var(--light-1);
    }
    
    .odd-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .odd-btn:nth-child(1) { border-top: 3px solid var(--success); }
    .odd-btn:nth-child(2) { border-top: 3px solid var(--warning); }
    .odd-btn:nth-child(3) { border-top: 3px solid #ff9e00; }
    .odd-btn:nth-child(4) { border-top: 3px solid var(--secondary); }
    .odd-btn:nth-child(5) { border-top: 3px solid var(--danger); }
    
    .odd-btn span:first-child {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 3px;
    }
    
    .odd-btn span:last-child {
      font-size: 0.8rem;
      opacity: 0.8;
    }
    
    .results {
      background: var(--dark-3);
      border-radius: 10px;
      padding: 20px;
      margin-top: 25px;
      border-left: 4px solid var(--primary);
    }
    
    .result-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .result-item:last-child {
      border-bottom: none;
    }
    
    .result-item .label {
      color: var(--light-2);
      font-weight: 500;
    }
    
    .result-item .value {
      font-weight: 600;
    }
    
    .countdown {
      background: rgba(6, 214, 160, 0.1);
      border-left: 4px solid var(--success);
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      text-align: center;
      font-weight: 600;
      font-size: 1.1rem;
    }
    
    .history-container {
      margin-top: 30px;
    }
    
    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .history-header h3 {
      font-weight: 500;
    }
    
    .history-clear-btn {
      background: transparent;
      color: var(--danger);
      border: 1px solid var(--danger);
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .history-clear-btn:hover {
      background: rgba(255, 0, 110, 0.1);
    }
    
    .history-list {
      background: var(--dark-3);
      border-radius: 10px;
      overflow: hidden;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .history-item {
      padding: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      align-items: center;
      transition: all 0.2s ease;
      position: relative;
    }
    
    .history-item.active {
      background: rgba(6, 214, 160, 0.05);
      border-left: 3px solid var(--success);
    }
    
    .history-item:last-child {
      border-bottom: none;
    }
    
    .history-time {
      font-size: 0.9rem;
      color: var(--light-2);
    }
    
    .history-multiplier {
      font-weight: 600;
      text-align: center;
    }
    
    .history-multiplier span {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
    }
    
    .history-multiplier-2 span { background: rgba(6, 214, 160, 0.2); color: var(--success); }
    .history-multiplier-3 span { background: rgba(255, 190, 11, 0.2); color: var(--warning); }
    .history-multiplier-4 span { background: rgba(255, 158, 0, 0.2); color: #ff9e00; }
    .history-multiplier-7 span { background: rgba(131, 56, 236, 0.2); color: var(--secondary); }
    .history-multiplier-10 span { background: rgba(255, 0, 110, 0.2); color: var(--danger); }
    
    .history-details {
      text-align: right;
      font-size: 0.85rem;
    }
    
    .history-details span {
      display: block;
      margin-bottom: 3px;
    }
    
    .copy-btn {
      position: absolute;
      right: 15px;
      top: 15px;
      background: rgba(58, 134, 255, 0.2);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      padding: 5px 10px;
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .copy-btn:hover {
      background: rgba(58, 134, 255, 0.3);
    }

    .copy-result-btn {
      background: rgba(58, 134, 255, 0.2);
      color: var(--primary);
      border: none;
      border-radius: 8px;
      padding: 10px 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 15px;
      width: 100%;
    }
    
    .copy-result-btn:hover {
      background: rgba(58, 134, 255, 0.3);
    }
    
    .footer {
      text-align: center;
      padding: 15px;
      font-size: 0.8rem;
      color: var(--light-2);
      opacity: 0.7;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    @media (max-width: 768px) {
      .odd-buttons {
        grid-template-columns: repeat(3, 1fr);
      }
      
      .history-item {
        grid-template-columns: 1fr 1fr;
      }
      
      .history-details {
        grid-column: span 2;
        text-align: left;
        margin-top: 8px;
      }
    }
    
    @media (max-width: 480px) {
      .odd-buttons {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .header h1 {
        font-size: 1.5rem;
      }
      
      .content {
        padding: 20px 15px;
      }
      
      .copy-btn {
        position: static;
        margin-top: 10px;
        width: 100%;
        justify-content: center;
      }
    }
    
    /* Animation for active signal */
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(6, 214, 160, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(6, 214, 160, 0); }
      100% { box-shadow: 0 0 0 0 rgba(6, 214, 160, 0); }
    }
    
    .active-signal {
      animation: pulse 2s infinite;
    }

    /* Custom Dialog Styles */
    .dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .dialog-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .dialog-box {
      background: var(--dark-2);
      border-radius: 10px;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      transform: translateY(20px);
      transition: transform 0.3s ease;
    }

    .dialog-overlay.active .dialog-box {
      transform: translateY(0);
    }

    .dialog-title {
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: var(--light-1);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .dialog-message {
      margin-bottom: 20px;
      color: var(--light-2);
      line-height: 1.5;
    }

    .dialog-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .dialog-btn {
      padding: 8px 15px;
      border-radius: 5px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .dialog-btn-cancel {
      background: var(--dark-3);
      color: var(--light-1);
      border: 1px solid var(--dark-3);
    }

    .dialog-btn-cancel:hover {
      background: var(--dark-1);
    }

    .dialog-btn-confirm {
      background: var(--danger);
      color: white;
      border: 1px solid var(--danger);
    }

    .dialog-btn-confirm:hover {
      background: #e00064;
    }

    .dialog-icon {
      font-size: 1.5rem;
      color: var(--danger);
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div class="header">
      <h1>XTREME AVIATOR SHA512 HASH HIGH PREDICTOR PRO</h1>
      <p>Advanced prediction algorithm for optimal results</p>
    </div>
    
    <div class="datetime">
      <div id="current-date"></div>
      <div id="current-time"></div>
    </div>
    
    <div class="content">
      <div class="input-group">
        <label for="hashInput">Enter SHA512 Hash</label>
        <input type="text" id="hashInput" placeholder="Paste your hash here...">
        <div class="input-actions">
          <button class="clear-btn" id="clearHashInput">
            <i class="fas fa-times"></i> Clear
          </button>
        </div>
      </div>
      
      <div class="odd-buttons">
        <button class="odd-btn" onclick="predict('2')">
          <span>2x</span>
          <span>Low Risk</span>
        </button>
        <button class="odd-btn" onclick="predict('3')">
          <span>3x</span>
          <span>Balanced</span>
        </button>
        <button class="odd-btn" onclick="predict('4')">
          <span>4x</span>
          <span>Moderate</span>
        </button>
        <button class="odd-btn" onclick="predict('7')">
          <span>7x</span>
          <span>High Risk</span>
        </button>
        <button class="odd-btn" onclick="predict('10')">
          <span>10x</span>
          <span>Extreme</span>
        </button>
      </div>
      
      <div class="results" id="output">
        <div class="result-item">
          <span class="label">Target Multiplier:</span>
          <span class="value" id="result-odd">-</span>
        </div>
        <div class="result-item">
          <span class="label">Hash Entropy:</span>
          <span class="value" id="result-entropy">-</span>
        </div>
        <div class="result-item">
          <span class="label">Hash Score:</span>
          <span class="value" id="result-score">-</span>
        </div>
        <div class="result-item">
          <span class="label">Estimated Delay:</span>
          <span class="value" id="result-delay">-</span>
        </div>
        <div class="result-item">
          <span class="label">Next Signal Time:</span>
          <span class="value" id="result-time">-</span>
        </div>
        <button class="copy-result-btn" onclick="copyResultToClipboard(event)">
          <i class="fas fa-copy"></i> Copy Signal
        </button>
      </div>
      
      <div class="countdown" id="countdown"></div>
      
      <div class="history-container">
        <div class="history-header">
          <h3><i class="fas fa-history"></i> Prediction History</h3>
          <button class="history-clear-btn" onclick="showClearDialog()">
            <i class="fas fa-trash-alt"></i> Clear
          </button>
        </div>
        <div class="history-list" id="historyLog"></div>
      </div>
    </div>
    
    <div class="footer">
      Xtreme Aviator SHA512 Hash High Predictor Pro © <span id="current-year"></span> | All Rights Reserved
    </div>
  </div>

  <!-- Custom Dialogs -->
  <div class="dialog-overlay" id="clearDialog">
    <div class="dialog-box">
      <div class="dialog-title">
        <i class="fas fa-exclamation-triangle dialog-icon"></i>
        Confirm Clear History
      </div>
      <div class="dialog-message">Are you sure you want to clear all prediction history?</div>
      <div class="dialog-buttons">
        <button class="dialog-btn dialog-btn-cancel" onclick="hideClearDialog()">Cancel</button>
        <button class="dialog-btn dialog-btn-confirm" onclick="clearHistory()">OK</button>
      </div>
    </div>
  </div>

  <div class="dialog-overlay" id="errorDialog">
    <div class="dialog-box">
      <div class="dialog-title">
        <i class="fas fa-exclamation-circle dialog-icon"></i>
        Invalid Input
      </div>
      <div class="dialog-message" id="errorMessage">Invalid SHA512 hash. Must be exactly 128 hexadecimal characters.</div>
      <div class="dialog-buttons">
        <button class="dialog-btn dialog-btn-confirm" onclick="hideErrorDialog()">OK</button>
      </div>
    </div>
  </div>

  <audio id="signalSound" src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3" preload="auto"></audio>
  <textarea id="copyTemplate" style="position: absolute; left: -9999px;"></textarea>

  <script>
    // Update current date and time
    function updateDateTime() {
      const now = new Date();
      document.getElementById("current-date").textContent = now.toLocaleDateString('en-US', { 
        weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' 
      });
      document.getElementById("current-time").textContent = now.toLocaleTimeString();
      document.getElementById("current-year").textContent = now.getFullYear();
    }
    
    setInterval(updateDateTime, 1000);
    updateDateTime();

    // Clear hash input
    document.getElementById("clearHashInput").addEventListener('click', function() {
      document.getElementById("hashInput").value = '';
    });

    // Allow text selection and pasting in input field
    document.getElementById("hashInput").addEventListener('contextmenu', function(e) {
      e.stopPropagation(); // Allow context menu for input field
    });

    // Audio functions
    function playSignalSound() {
      const audio = document.getElementById("signalSound");
      audio.currentTime = 0;
      audio.play().catch(e => console.log("Audio play failed:", e));
    }

    // Core prediction functions
    function calcEntropy(hash) {
      const freq = {};
      for (let c of hash) freq[c] = (freq[c] || 0) + 1;
      return Object.values(freq).reduce((acc, f) => {
        const p = f / hash.length;
        return acc - p * Math.log2(p);
      }, 0);
    }

    function scoreFromHash(hash) {
      const indexes = [10, 25, 50, 75, 100];
      return indexes.reduce((sum, i) => sum + parseInt(hash[i], 16), 0);
    }

    function calculateDelay(score, entropy, oddTarget, hash) {
      let base = parseInt(oddTarget) * 60;

      if (entropy > 3.6) base += 30;
      if (score % 10 === 7 || score % 10 === 3) base += 45;
      if (score % 5 === 0) base -= 20;

      if (/([a-f0-9])\1{2,}/.test(hash)) base += 60;
      if (["aa", "ff", "11", "00"].includes(hash.slice(-2))) base += 30;

      if (oddTarget === "10") base += 90;

      return Math.max(60, base);
    }

    // Countdown and active signal tracking
    let activeSignals = [];
    let currentCountdown = null;
    
    function updateCountdown(targetTime, odd) {
      // Clear any existing countdown
      if (currentCountdown) {
        clearInterval(currentCountdown);
      }
      
      const signalId = Date.now();
      activeSignals.push({ id: signalId, time: targetTime, odd });
      
      currentCountdown = setInterval(() => {
        const now = new Date();
        const diff = Math.floor((targetTime - now) / 1000);
        
        if (diff <= 0) {
          clearInterval(currentCountdown);
          document.getElementById("countdown").textContent = `Signal for ${odd}x reached! Place your bet now!`;
          document.getElementById("countdown").style.backgroundColor = "rgba(6, 214, 160, 0.2)";
          document.getElementById("countdown").style.borderLeftColor = "var(--success)";
          playSignalSound();
          highlightActiveSignal(signalId);
          removeSignal(signalId);
          
          // Check for next signal after this one completes
          setTimeout(checkNextSignal, 1000);
        } else {
          const min = Math.floor(diff / 60);
          const sec = diff % 60;
          document.getElementById("countdown").textContent = `Next ${odd}x signal in: ${min}m ${sec}s`;
        }
      }, 1000);
    }

    function checkNextSignal() {
      const now = new Date();
      const history = JSON.parse(localStorage.getItem('aviatorHistory')) || [];
      
      // Find the next upcoming signal that hasn't passed yet
      const upcomingSignals = history.filter(item => {
        const signalTime = new Date(parseInt(item.timestamp));
        return signalTime > now;
      }).sort((a, b) => a.timestamp - b.timestamp);
      
      if (upcomingSignals.length > 0) {
        const nextSignal = upcomingSignals[0];
        const signalTime = new Date(parseInt(nextSignal.timestamp));
        updateCountdown(signalTime, nextSignal.odd);
      } else {
        document.getElementById("countdown").textContent = "No active signals. Create a new prediction.";
        document.getElementById("countdown").style.backgroundColor = "rgba(255, 190, 11, 0.1)";
        document.getElementById("countdown").style.borderLeftColor = "var(--warning)";
      }
    }

    function highlightActiveSignal(id) {
      const historyItems = document.querySelectorAll('.history-item');
      historyItems.forEach(item => {
        if (item.dataset.id == id) {
          item.classList.add('active', 'active-signal');
          setTimeout(() => {
            item.classList.remove('active-signal');
          }, 10000);
        }
      });
    }

    function removeSignal(id) {
      activeSignals = activeSignals.filter(signal => signal.id !== id);
    }

    // Generate WhatsApp message template
    function generateWhatsAppTemplate(odd, timeStr) {
      let riskText = "";
      if (odd === "10") {
        riskText = " (Very High Risk)";
      } else if (odd === "7") {
        riskText = " (Risk)";
      }
      
      return `Xtreme Aviator Predictor - 1xBet\n\nTime: ${timeStr}\nOdd: ${odd}×${riskText}\n\nThis signal is generated using the XTREME AVIATOR SHA512 HASH HIGH PREDICTOR PRO tool.`;
    }

    // Generate result copy template
    function generateResultCopyTemplate() {
      const odd = document.getElementById("result-odd").textContent;
      const time = document.getElementById("result-time").textContent;
      
      let riskText = "";
      if (odd === "10x") {
        riskText = " (Very High Risk)";
      } else if (odd === "7x") {
        riskText = " (Risk)";
      }
      
      return `Xtreme Aviator Predictor - 1xBet\n\nTime: ${time}\nOdd: ${odd}${riskText}\n\nThis signal is generated using the XTREME AVIATOR SHA512 HASH HIGH PREDICTOR PRO tool.`;
    }

    // Copy to clipboard function
    function copyToClipboard(text) {
      const textarea = document.getElementById("copyTemplate");
      textarea.value = text;
      textarea.select();
      document.execCommand("copy");
      
      // Show feedback
      const originalText = document.activeElement.innerHTML;
      document.activeElement.innerHTML = '<i class="fas fa-check"></i> Copied!';
      setTimeout(() => {
        document.activeElement.innerHTML = originalText;
      }, 2000);
    }

    function copyResultToClipboard(e) {
      e.preventDefault(); // Prevent keyboard from opening on mobile
      const template = generateResultCopyTemplate();
      copyToClipboard(template);
    }

    // History functions
    function logHistory(odd, timeStr, entropy, score, delay) {
      const log = document.getElementById("historyLog");
      const entry = document.createElement("div");
      entry.className = `history-item history-multiplier-${odd}`;
      entry.dataset.id = Date.now();
      entry.dataset.time = new Date(Date.now() + delay * 1000).getTime();
      
      entry.innerHTML = `
        <div class="history-time">
          <i class="far fa-clock"></i> ${new Date().toLocaleTimeString()}
        </div>
        <div class="history-multiplier">
          <span>${odd}x</span>
        </div>
        <div class="history-details">
          <span><i class="fas fa-bolt"></i> ${timeStr}</span>
          <span><i class="fas fa-chart-line"></i> Score: ${score}</span>
          <span><i class="fas fa-random"></i> Entropy: ${entropy.toFixed(2)}</span>
        </div>
        <button class="copy-btn" onclick="copySignalToClipboard(event, '${odd}', '${timeStr}')">
          <i class="fas fa-copy"></i> Copy
        </button>
      `;
      
      log.insertBefore(entry, log.firstChild);
      
      // Save to localStorage
      const history = JSON.parse(localStorage.getItem('aviatorHistory')) || [];
      history.unshift({
        id: entry.dataset.id,
        time: new Date().toLocaleTimeString(),
        odd,
        signalTime: timeStr,
        score,
        entropy: entropy.toFixed(2),
        delay,
        timestamp: entry.dataset.time
      });
      localStorage.setItem('aviatorHistory', JSON.stringify(history));
    }

    function copySignalToClipboard(e, odd, timeStr) {
      e.preventDefault(); // Prevent keyboard from opening on mobile
      const template = generateWhatsAppTemplate(odd, timeStr);
      copyToClipboard(template);
    }

    // Dialog functions
    function showClearDialog() {
      document.getElementById("clearDialog").classList.add("active");
    }

    function hideClearDialog() {
      document.getElementById("clearDialog").classList.remove("active");
    }

    function showErrorDialog(message) {
      document.getElementById("errorMessage").textContent = message;
      document.getElementById("errorDialog").classList.add("active");
    }

    function hideErrorDialog() {
      document.getElementById("errorDialog").classList.remove("active");
    }

    function clearHistory() {
      document.getElementById("historyLog").innerHTML = '';
      localStorage.removeItem('aviatorHistory');
      document.getElementById("countdown").textContent = "No active signals. Create a new prediction.";
      document.getElementById("countdown").style.backgroundColor = "rgba(255, 190, 11, 0.1)";
      document.getElementById("countdown").style.borderLeftColor = "var(--warning)";
      if (currentCountdown) {
        clearInterval(currentCountdown);
        currentCountdown = null;
      }
      hideClearDialog();
    }

    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('aviatorHistory')) || [];
      const log = document.getElementById("historyLog");
      log.innerHTML = '';
      
      // Sort by timestamp (newest first)
      history.sort((a, b) => b.timestamp - a.timestamp);
      
      history.forEach(item => {
        const entry = document.createElement("div");
        entry.className = `history-item history-multiplier-${item.odd}`;
        entry.dataset.id = item.id;
        entry.dataset.time = item.timestamp;
        
        // Check if this signal is currently active
        const now = new Date();
        const signalTime = new Date(parseInt(item.timestamp));
        if (now >= signalTime && now <= new Date(signalTime.getTime() + 10000)) {
          entry.classList.add('active');
        }
        
        entry.innerHTML = `
          <div class="history-time">
            <i class="far fa-clock"></i> ${item.time}
          </div>
          <div class="history-multiplier">
            <span>${item.odd}x</span>
          </div>
          <div class="history-details">
            <span><i class="fas fa-bolt"></i> ${item.signalTime}</span>
            <span><i class="fas fa-chart-line"></i> Score: ${item.score}</span>
            <span><i class="fas fa-random"></i> Entropy: ${item.entropy}</span>
          </div>
          <button class="copy-btn" onclick="copySignalToClipboard(event, '${item.odd}', '${item.signalTime}')">
            <i class="fas fa-copy"></i> Copy
          </button>
        `;
        
        log.appendChild(entry);
      });
      
      // Check for active signals on load
      checkNextSignal();
    }

    // Main prediction function
    function predict(oddStr) {
      const hash = document.getElementById("hashInput").value.trim().toLowerCase();
      const output = document.getElementById("output");

      if (!hash || hash.length !== 128 || !/^[a-f0-9]+$/.test(hash)) {
        showErrorDialog("Invalid SHA512 hash. Must be exactly 128 hexadecimal characters.");
        return;
      }

      const entropy = calcEntropy(hash);
      const score = scoreFromHash(hash);
      const delay = calculateDelay(score, entropy, oddStr, hash);
      const future = new Date(Date.now() + delay * 1000);
      const timeStr = future.toLocaleTimeString();

      // Update results display
      document.getElementById("result-odd").textContent = `${oddStr}x`;
      document.getElementById("result-entropy").textContent = entropy.toFixed(3);
      document.getElementById("result-score").textContent = score;
      document.getElementById("result-delay").textContent = `${delay} seconds`;
      document.getElementById("result-time").textContent = timeStr;
      
      output.style.display = 'block';
      updateCountdown(future, oddStr);
      logHistory(oddStr, timeStr, entropy, score, delay);
    }

    // Initialize on load
    window.onload = function() {
      loadHistory();
      updateDateTime();
    };
  </script>
</body>
</html>
